# 一、背景
C++是被很多google开源软件主要采用的开发语言之一。众所周知，这门语言有很多强大的特性，这种强大的特性使得C++的复杂性非常高，导致用C++写出来的代码容易出错，阅读困难，难以维护。

这份指南详细的给出了一些关于写C++代码的一些建议和规则，以期可以来降低C++带来的复杂性。这些规则在不影响使用C++特性的情况下，保持代码具有高度的可组织性。

我们把组织代码的习惯，叫做风格，或者说可读性。风格这个词其实是有些偏差的，因为组织代码的习惯涵盖的不单单指源代码组织的格式。

大部分google开发的开源项目都遵从本指南提到的要求。

注意：本指南不是一个C++的新手指南，我们假定读者都是已经熟悉了这门语言的。

## 本指南的目标
为什么我们需要这份文档？

我们形成这份指南，是有一些核心准则，这些准则是构建所有指南中各条独特规则的基本原因。特意在这里把这些准则提前抛出来，作为讨论的基础，让社区更广泛更清晰的了解一条规则是经过哪些特殊的讨论才制定出来。当我们深刻的了解一条规则的目的是什么，那么大家就应该清楚的知道当我们在修改、替换或者废除一条规则的时候，需要经过哪些必要的讨论。

这份指南的主要考量点包括：

规则需要有起独有的作用
> 一条规则的收益必须足够大，值得所有的工程师记住它。一条规则的收益可以通过这种方式来衡量：不使用该规则编写出来的代码和使用该规则编写出来的代码是否会有什么差别？有一些非常有害的做法，虽然有点好处，然而人们普遍都不怎么使用了，那么一条明确指出这种有害做法不可取的规则就没有什么价值。这条原则主要解释本指南为什么没有包含某些规则，而不是指南中为什么包含了某些规则，这样的规则就没有什么收益了。例如，goto语句违反了如下大部分的原则，但是基本上已经很少人使用了，这种情况就不在本指南的讨论范围中了。

为代码读者优化，而不是为代码作者
> 我们编写的代码库或者组件，往往会持续服务很长一段时间。大部分的时间都被用来阅读代码，而不是去修改代码，所以，我们可以很明确的确定准则，让我们的工程师在阅读、维护、调试的时候更有效率，而不是让我们更轻松的去编写代码。为读者留下指引是这条准则中很重要的一点，在一些奇怪或者不寻常的代码处，留下一些文本的提示就很有用。

与现有代码保持一致
> 在整段代码库中使用同一种风格，可以让我们少些纠结，更专注于其他一些更重要的问题上去。一致性可以使用工具来实现自动化。很多时候，一致性规则会让人们选择这种做法：只选择一种风格，就不用再担心这个问题了；在这些点上允许灵活性的潜在价值超过了人们针对它争吵的代价。

在适当的时候与更广泛的C++社区保持一致
> 与其他组织的C++代码风格保持一致的道理和保持自己代码风格一致的道理是一样的。如果一个特性解决了世界问题，或者一个习惯用法被广泛知晓并接收，那么这可以成为一个我们使用它的一个理由。然而，有些时候标准的特性或者习惯用法是有缺陷的，或者其设计并不能满足我们的实际需要，这时候可以适当的限制或者禁止标准特性。这种情况下，理解成本上的优势或者代码库还不足以转换为标准接口，我们选择本地的或者第三方基于C++标准构建的库。

避免使用奇怪的或者危险的结构
> C++有一些比人们想象中更新奇和危险的特性。有一些指南明确限制不要使用，以免掉坑。取消限制使用这些特性是一个高杆，因为使用这些特性往往对程序员有较高的要求，取消对于这些特性的使用限制通常会直接影响程序的正确性。
避免使用大部分C++程序员觉得维护起来棘手或者困难的结构

避免使用大多数C++程序员认为很难维护的结构
> C++很多特性在引入的同时带来了很高的复杂度，可能并不适用于通用的场景。在广泛使用的代码中，由于复杂性的带来的收益由于广泛使用被放大，重新使用代码库并不会带来复杂性理解上的成本增加，这种情况下是可取的。当有疑问的时候，可以咨询你的项目主管是否需要保留这些特性。这对于我们自己维护的代码库很重要，因为代码所有权和团队成员时刻在变动，对于一段代码，尽管一段时间内所有人都理解，但并不保证一段时间以后依然如是。

注意使用规模
> 对于上亿行代码和数千名工程师的代码库，一个工程师的一些错误和简化会变得代价高昂。例如避免污染全局命名空间特别重要，在一个上亿行级别的代码库中，如果每个人都往全局命名空间里塞东西，很难避免命名冲突。

适时优化
> 在合适的时候进行优化很有必要。尽管可能会与本文档中的其他原则有冲突，也要进行。

本文的目的旨在一些合理的限制上提供一些通用的指导。当然，一些常识性的东西和良好的品味需要提倡。我们在这里特别参考整个google C++社区的管理，而不仅仅是你个人的偏好和你团队的惯例。对于那些聪明或者不寻常的构建方法，需要保持谨慎，没有明确禁止并不代表给你发了通行证。你需要有自己的判断，如果你不确定，不要犹豫，想你的项目主管寻求有效的建议吧。
